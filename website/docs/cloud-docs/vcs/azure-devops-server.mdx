---
page_title: Azure DevOps Server - VCS Providers - Terraform Cloud
---

# Configuring Azure DevOps Server Access

These instructions are for using an on-premises installation of Azure DevOps Server 2019 for Terraform Cloud's VCS features. [Azure DevOps Services has separate instructions,](/cloud-docs/vcs/azure-devops-services) as do the [other supported VCS providers.](/cloud-docs/vcs)

Configuring a new VCS provider requires permission to manage VCS settings for the organization. ([More about permissions.](/cloud-docs/users-teams-organizations/permissions))

[permissions-citation]: #intentionally-unused---keep-for-maintainers

## Important Notes About Authentication

Terraform Cloud uses personal access tokens to connect to Azure DevOps Server. This access method requires some additional configuration and ongoing maintenance:

- [IIS Basic Authentication must be disabled](https://docs.microsoft.com/en-us/azure/devops/integrate/get-started/authentication/iis-basic-auth?view=azure-devops) on your Azure DevOps Server instance in order to use personal access tokens.
- Personal access tokens eventually expire with a maximum allowed lifetime of one year. If Terraform Cloud's token expires, it cannot connect to Azure DevOps Server until you replace the token. To avoid a gap in service, do one of the following before the token expires:
  - Update the expiration date of the existing token within Azure DevOps Server.
  - Create a new token and edit Terraform Cloud's VCS connection to use it.

## Adding a New VCS Provider

1. Open Terraform Cloud in your browser and navigate to **Settings > Version Control > Providers** for your organization.

1. Click **Add VCS Provider**. If you just created your organization, you might already be on this page. Otherwise:

   1. Make sure the bottom-left organization menu currently shows your organization.
   1. Click the **Settings** link at the top of the page (or within the â˜° menu).
   1. On the next page, click **Providers** under **Version Control** in the left sidebar.
   1. Click **Add a VCS Provider**.

1. To connect an Azure DevOps server as your version control provider, select **Azure DevOps Server** from the **Azure DevOps** dropdown. The page moves to the next step.

1. Enter an optional **Name** for this VCS connection.

1. Enter the instance URLs for your Azure DevOps Server in the **HTTP URL** and **API URL** textboxes.

1. Click **Continue**. Leave the page open in a browser tab for later use.

## Creating a New Personal Access Token

1. In a new browser tab, open your Azure DevOps Server instance and log in as whichever account you want Terraform Cloud to act as. For most organizations, this account should be a dedicated service user, but a personal account also works.

   ~> **Important:** The account you use for connecting Terraform Cloud must have Project Collection Administrator access to any projects containing repositories of Terraform configurations because creating webhooks requires these permissions. You cannot create custom access roles with lower levels of privilege because Microsoft does not currently allow delegation of this capability.

1. Navigate to **User settings > Security > Personal access tokens**.

1. Click **New Token** to generate a new personal access token with `Code (Read)` and `Code (Status)` scopes. We recommend also granting access to **All accessible organizations.**

1. Copy the generated token to your clipboard for later use. Leave this page open in a browser tab.

## Adding the Personal Access Token

1. Enter your Azure DevOps Server **Personal Access Token**.

1. Click **Continue**.

## Creating an SSH Key for Terraform Cloud

1. On a secure workstation, create an SSH keypair that Terraform Cloud can use to connect to Azure DevOps Server. The exact command depends on your OS, but is usually something like `ssh-keygen -t rsa -m PEM -f "/Users/<NAME>/.ssh/service_terraform" -C "service_terraform_enterprise"`. This action creates a `service_terraform` file with the private key and a `service_terraform.pub` file with the public key.

~> **Important:** This SSH key must have an empty passphrase. Terraform Cloud cannot use SSH keys that require a passphrase.

### Important Notes

- Do not use your personal SSH key to connect Terraform Cloud and Azure DevOps Server. Generate a new key or use an existing key reserved for service access.
- In upcoming steps, you must provide Terraform Cloud with the private key. Although Terraform Cloud does not display the text of the key to users after you entered it, Terraform Cloud retains the text and uses it for authenticating to Azure DevOps Server.
- Protect this private key carefully. It can read code to the repositories you use to manage your infrastructure. Follow your organization's policies for protecting important credentials.

## Adding an SSH Public Key

1. Navigate to **User settings > Security > SSH public keys** on your Azure DevOps Server instance.

1. Click **Add**.

1. Paste the text of the **SSH public key** you created (from the `.pub` file) into the text field.

1. Click **Add key**.

## Adding an SSH Private Key

1. Return to your Terraform Cloud browser tab and paste the text of the **SSH private key** you created earlier into the **Private SSH Key** text field.

1. Click **Add SSH key**.

You successfully configured Azure DevOps Server access for Terraform Cloud. You can create Terraform workspaces based on your organization's repositories.
